<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#667eea">
  <meta name="description" content="é…ä¿¡è€…å°‚ç”¨ã‚«ãƒ¼ãƒ‰ãƒ‘ãƒƒã‚¯è²©å£²ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Pack&Play">
  <title>ç”°ä¸­å¤ªéƒ - Pack&Play</title>
  <link rel="stylesheet" href="../css/style.css">
  <link rel="manifest" href="../manifest.json">
  <link rel="icon" type="image/png" sizes="192x192" href="../assets/images/icon-192.png">
  <link rel="apple-touch-icon" href="../assets/images/icon-192.png">
  <style>
    body {
      overflow-x: hidden;
      background: #f9fafb;
      display: flex;
      min-height: 100vh;
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }

    /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ */
    .sidebar {
      position: fixed;
      left: 0;
      top: 0;
      bottom: 0;
      width: 260px;
      background: white;
      border-right: 1px solid #e5e7eb;
      padding: 2rem 1.5rem 1rem;
      display: flex;
      flex-direction: column;
      overflow-y: auto;
      z-index: 1000;
    }

    .sidebar-logo {
      display: block;
      text-decoration: none;
      margin-bottom: 2rem;
      transition: opacity 0.2s;
    }

    .sidebar-logo:hover {
      opacity: 0.8;
    }

    .sidebar-logo-img {
      width: 100%;
      max-width: 180px;
      height: auto;
      display: block;
    }

    .sidebar-nav {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      flex: 1;
    }

    .sidebar-nav-link {
      color: #2d1b3d;
      text-decoration: none;
      font-weight: 600;
      font-size: 1.125rem;
      padding: 1rem 1.25rem;
      border-radius: 0.75rem;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .sidebar-nav-link:hover {
      background: #f3f4f6;
    }

    .sidebar-nav-link.active {
      background: #f3f4f6;
      color: #FF1B8D;
    }

    .sidebar-footer {
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 1px solid #e5e7eb;
    }

    .sidebar-footer-links {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      margin-bottom: 0.75rem;
    }

    .sidebar-footer-link {
      color: #6b7280;
      text-decoration: none;
      font-size: 0.8125rem;
      transition: color 0.2s;
    }

    .sidebar-footer-link:hover {
      color: #2d1b3d;
      text-decoration: underline;
    }

    .sidebar-footer-copyright {
      color: #9ca3af;
      font-size: 0.75rem;
      line-height: 1.4;
    }

    /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ */
    .main-wrapper {
      margin-left: 260px;
      flex: 1;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    .creator-content {
      width: 100%;
      max-width: 680px;
      margin: 0 auto;
      background: white;
    }

    /* é…ä¿¡è€…æƒ…å ±ãƒãƒ¼ï¼ˆçµ±åˆç‰ˆï¼‰ */
    .creator-info-section {
      display: flex;
      align-items: center;
      gap: 1rem;
      flex: 1;
      min-width: 0;
    }

    .creator-avatar {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 700;
      font-size: 1.25rem;
      flex-shrink: 0;
      position: relative;
    }

    .creator-info-text {
      min-width: 0;
      flex: 1;
    }

    .creator-name {
      font-size: 1.125rem;
      font-weight: 800;
      color: #2d1b3d;
      margin-bottom: 0.25rem;
    }

    .creator-meta {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      flex-wrap: wrap;
    }

    /* é…ä¿¡ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ */
    .stream-player-wrapper {
      position: relative;
      width: 100%;
      padding-bottom: 56.25%; /* 16:9 aspect ratio */
      background: #000;
    }

    .stream-player {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: none;
    }

    .stream-offline {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      gap: 1rem;
    }

    .stream-offline-icon {
      font-size: 4rem;
    }

    .stream-offline-text {
      font-size: 1.25rem;
      font-weight: 700;
    }

    /* é…ä¿¡æƒ…å ±ãƒãƒ¼ */
    .stream-info-bar {
      background: white;
      padding: 1rem 1.5rem;
      border-bottom: 1px solid #e5e7eb;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 1rem;
    }

    .stream-info-bar .following-button {
      align-self: center;
    }


    .follower-count {
      color: #6b7280;
      font-size: 0.8125rem;
      font-weight: 500;
    }

    /* é…ä¿¡æ¦‚è¦ï¼ˆã‚¿ãƒ–å†…ï¼‰ */
    .stream-description-content {
      color: #2d1b3d;
      font-size: 0.9375rem;
      line-height: 1.6;
      white-space: pre-wrap;
      word-wrap: break-word;
      position: relative;
      overflow: hidden;
      transition: max-height 0.3s ease;
      padding-bottom: 0.5rem;
    }

    .stream-description-content.collapsed {
      max-height: 4.8rem; /* ç´„3è¡Œåˆ† */
    }

    .stream-description-content.expanded {
      max-height: none;
    }

    .stream-description-wrapper {
      position: relative;
    }

    .stream-description-fade {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 2rem;
      background: linear-gradient(to bottom, transparent, white);
      pointer-events: none;
    }

    .stream-description-content.expanded + .stream-description-fade {
      display: none;
    }

    .stream-description-toggle {
      margin-top: 0.5rem;
      background: transparent;
      border: none;
      color: #FF1B8D;
      font-weight: 600;
      font-size: 0.875rem;
      cursor: pointer;
      padding: 0;
      display: flex;
      align-items: center;
      gap: 0.25rem;
      transition: opacity 0.2s;
    }

    .stream-description-toggle:hover {
      opacity: 0.8;
    }

    .stream-description-toggle svg {
      width: 16px;
      height: 16px;
      transition: transform 0.3s ease;
    }

    .stream-description-toggle.expanded svg {
      transform: rotate(180deg);
    }

    .stream-description-empty {
      color: #9ca3af;
      font-size: 0.875rem;
      text-align: center;
      padding: 2rem 1rem;
    }

    /* ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ‘ãƒãƒ« */
    .action-panel {
      background: white;
      border-bottom: 1px solid #e5e7eb;
    }

    .action-tabs {
      display: flex;
      border-bottom: 1px solid #e5e7eb;
    }

    .action-tab {
      flex: 1;
      padding: 1rem;
      background: transparent;
      border: none;
      border-bottom: 2px solid transparent;
      font-weight: 600;
      font-size: 1rem;
      color: #6b7280;
      cursor: pointer;
      transition: all 0.2s;
    }

    .action-tab:hover {
      background: #f9fafb;
    }

    .action-tab.active {
      color: #FF1B8D;
      border-bottom-color: #FF1B8D;
    }

    .action-content {
      display: none;
      padding: 1.5rem;
      max-height: calc(100vh - 650px);
      min-height: 300px;
      overflow-y: auto;
    }

    /* ã‚¹ãƒ—ãƒ©ãƒƒã‚·ãƒ¥ã‚¿ãƒ–ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å¹…åˆ¶é™ */
    #splashContent {
      max-width: 480px;
      margin: 0 auto;
      padding: 1.5rem 2rem;
    }

    .action-content::-webkit-scrollbar {
      width: 6px;
    }

    .action-content::-webkit-scrollbar-track {
      background: #f3f4f6;
    }

    .action-content::-webkit-scrollbar-thumb {
      background: #d1d5db;
      border-radius: 3px;
    }

    .action-content::-webkit-scrollbar-thumb:hover {
      background: #9ca3af;
    }

    .action-content.active {
      display: block;
    }

    /* ã‚«ãƒ¼ãƒ‰ã‚°ãƒªãƒƒãƒ‰ */
    .cards-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 1rem;
    }

    .card-item {
      background: white;
      border: 2px solid #e5e7eb;
      border-radius: 0.75rem;
      padding: 1rem 0.75rem;
      transition: all 0.2s;
      text-align: center;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .card-item:hover {
      border-color: #FF1B8D;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(255, 27, 141, 0.15);
    }

    .card-icon-large {
      font-size: 2.5rem;
      margin-bottom: 0.25rem;
    }

    .card-name {
      font-weight: 600;
      font-size: 0.875rem;
      color: #2d1b3d;
      margin-bottom: 0.25rem;
    }

    .use-btn {
      padding: 0.375rem 0.75rem;
      border-radius: 0.375rem;
      border: none;
      background: #FF1B8D;
      color: white;
      font-weight: 600;
      font-size: 0.8125rem;
      cursor: pointer;
      transition: all 0.2s;
      margin-top: auto;
    }

    .use-btn:hover {
      background: #e01677;
      transform: translateY(-1px);
    }

    .cards-empty {
      text-align: center;
      padding: 3rem 1rem;
      color: #9ca3af;
    }

    /* ã‚«ãƒ¼ãƒ‰ä½¿ç”¨ãƒ¢ãƒ¼ãƒ€ãƒ« */
    .use-card-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 9999;
      align-items: center;
      justify-content: center;
      padding: 1rem;
    }

    .use-card-modal.active {
      display: flex;
    }

    .use-card-modal-content {
      background: white;
      border-radius: 1rem;
      padding: 2rem;
      max-width: 400px;
      width: 100%;
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
    }

    .use-card-modal-header {
      text-align: center;
      margin-bottom: 1.5rem;
    }

    .use-card-modal-icon {
      font-size: 4rem;
      margin-bottom: 1rem;
    }

    .use-card-modal-title {
      font-size: 1.25rem;
      font-weight: 700;
      color: #2d1b3d;
      margin-bottom: 0.75rem;
    }

    .use-card-modal-header .badge {
      display: inline-block;
    }

    .use-card-modal-message {
      color: #6b7280;
      font-size: 0.9375rem;
      margin-bottom: 1.5rem;
      text-align: center;
    }

    .use-card-modal-buttons {
      display: flex;
      gap: 0.75rem;
    }

    .use-card-modal-button {
      flex: 1;
      padding: 0.75rem 1rem;
      border-radius: 0.5rem;
      border: none;
      font-weight: 600;
      font-size: 0.9375rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .use-card-modal-button-cancel {
      background: #f3f4f6;
      color: #6b7280;
    }

    .use-card-modal-button-cancel:hover {
      background: #e5e7eb;
    }

    .use-card-modal-button-confirm {
      background: #FF1B8D;
      color: white;
    }

    .use-card-modal-button-confirm:hover {
      background: #e01677;
    }

    /* ã‚«ãƒ¼ãƒ‰ä½¿ç”¨ãƒˆãƒ¼ã‚¹ãƒˆ */
    .card-use-toast {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0);
      background: white;
      border-radius: 1rem;
      padding: 2rem;
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.2);
      z-index: 10000;
      text-align: center;
      min-width: 300px;
      animation: cardUseToastIn 0.3s ease-out forwards;
    }

    @keyframes cardUseToastIn {
      0% {
        transform: translate(-50%, -50%) scale(0);
        opacity: 0;
      }
      50% {
        transform: translate(-50%, -50%) scale(1.1);
      }
      100% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
      }
    }

    .card-use-toast.fade-out {
      animation: cardUseToastOut 0.3s ease-out forwards;
    }

    @keyframes cardUseToastOut {
      from {
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
      }
      to {
        transform: translate(-50%, -50%) scale(0.8);
        opacity: 0;
      }
    }

    .card-use-toast-icon {
      font-size: 4rem;
      margin-bottom: 1rem;
      animation: iconBounce 0.6s ease-out;
    }

    @keyframes iconBounce {
      0%, 100% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.2);
      }
    }

    .card-use-toast-title {
      font-size: 1.25rem;
      font-weight: 700;
      color: #2d1b3d;
      margin-bottom: 0.5rem;
    }

    .card-use-toast-message {
      font-size: 0.9375rem;
      color: #6b7280;
      margin-bottom: 0.75rem;
    }

    .card-use-toast-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.3);
      z-index: 9999;
      opacity: 0;
      animation: overlayFadeIn 0.3s ease-out forwards;
    }

    .card-use-toast-overlay.fade-out {
      animation: overlayFadeOut 0.3s ease-out forwards;
    }

    @keyframes overlayFadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes overlayFadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }

    /* ã‚¹ãƒ—ãƒ©ãƒƒã‚·ãƒ¥ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ */
    .splash-preview {
      border-radius: 0.5rem;
      padding: 0.875rem;
      margin-bottom: 1rem;
      transition: all 0.3s ease;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      position: relative;
      overflow: hidden;
    }

    .splash-preview::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      opacity: 1;
      transition: all 0.3s ease;
    }

    .splash-preview-header {
      display: flex;
      align-items: center;
      gap: 0.625rem;
      margin-bottom: 0.625rem;
      position: relative;
      z-index: 1;
    }

    .splash-preview-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.25);
      backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 700;
      font-size: 1rem;
      flex-shrink: 0;
      border: 2px solid rgba(255, 255, 255, 0.3);
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    .splash-preview-info {
      flex: 1;
      min-width: 0;
    }

    .splash-preview-name {
      font-size: 0.875rem;
      font-weight: 700;
      color: white;
      margin-bottom: 0.125rem;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    .splash-preview-amount {
      font-size: 1rem;
      font-weight: 800;
      color: white;
      text-shadow: 0 3px 6px rgba(0, 0, 0, 0.3);
    }

    .splash-preview-message {
      position: relative;
      z-index: 1;
    }

    .splash-preview-input {
      width: 100%;
      padding: 0.625rem;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 0.375rem;
      font-size: 0.875rem;
      resize: vertical;
      min-height: 60px;
      font-family: inherit;
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(10px);
      color: white;
      transition: all 0.2s;
    }

    .splash-preview-input::placeholder {
      color: rgba(255, 255, 255, 0.7);
    }

    .splash-preview-input:focus {
      outline: none;
      border-color: rgba(255, 255, 255, 0.5);
      background: rgba(255, 255, 255, 0.2);
    }

    .splash-preview-input:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      background: rgba(255, 255, 255, 0.08);
    }

    /* é‡‘é¡ã”ã¨ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è‰² */
    .splash-preview[data-tier="1"]::before {
      background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
    }

    .splash-preview[data-tier="2"]::before {
      background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);
    }

    .splash-preview[data-tier="3"]::before {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    }

    .splash-preview[data-tier="4"]::before {
      background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
    }

    .splash-preview[data-tier="5"]::before {
      background: linear-gradient(135deg, #f97316 0%, #ea580c 100%);
    }

    .splash-preview[data-tier="6"]::before {
      background: linear-gradient(135deg, #FF1B8D 0%, #e01677 100%);
    }

    /* ã‚¹ãƒ©ã‚¤ãƒ‰ãƒãƒ¼ã‚³ãƒ³ãƒ†ãƒŠ */
    .splash-slider-container {
      margin-bottom: 0.75rem;
    }

    .splash-amount-input-wrapper {
      display: flex;
      justify-content: center;
      align-items: baseline;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }

    .splash-amount-input {
      width: 100px;
      padding: 0.375rem 0.25rem;
      border: none;
      border-bottom: 2px solid #d1d5db;
      background: transparent;
      font-size: 1.25rem;
      font-weight: 700;
      color: #2d1b3d;
      text-align: center;
      transition: all 0.2s;
      -moz-appearance: textfield;
    }

    .splash-amount-input:focus {
      outline: none;
      border-bottom-color: #FF1B8D;
    }

    /* ã‚¹ãƒ”ãƒ³ãƒœã‚¿ãƒ³ã‚’éè¡¨ç¤º */
    .splash-amount-input::-webkit-inner-spin-button,
    .splash-amount-input::-webkit-outer-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }

    .splash-amount-unit {
      font-size: 0.875rem;
      color: #6b7280;
      font-weight: 600;
    }

    .splash-slider-wrapper {
      width: 100%;
      margin-bottom: 0.75rem;
    }

    /* ã‚¹ãƒ©ã‚¤ãƒ‰ãƒãƒ¼ */
    .splash-slider {
      -webkit-appearance: none;
      appearance: none;
      width: 100%;
      height: 6px;
      border-radius: 4px;
      background: #e5e7eb;
      outline: none;
      transition: background 0.2s;
    }

    .splash-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #FF1B8D;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(255, 27, 141, 0.3);
      transition: all 0.2s;
    }

    .splash-slider::-webkit-slider-thumb:hover {
      transform: scale(1.15);
      box-shadow: 0 3px 10px rgba(255, 27, 141, 0.5);
    }

    .splash-slider::-webkit-slider-thumb:active {
      transform: scale(1.1);
    }

    .splash-slider::-moz-range-thumb {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #FF1B8D;
      cursor: pointer;
      border: none;
      box-shadow: 0 2px 6px rgba(255, 27, 141, 0.3);
      transition: all 0.2s;
    }

    .splash-slider::-moz-range-thumb:hover {
      transform: scale(1.15);
      box-shadow: 0 3px 10px rgba(255, 27, 141, 0.5);
    }

    .splash-slider::-moz-range-thumb:active {
      transform: scale(1.1);
    }

    .send-button {
      width: 100%;
      max-width: 100%;
      padding: 0.875rem;
      border-radius: 0.5rem;
      border: none;
      background: linear-gradient(135deg, #FF1B8D 0%, #e01677 100%);
      color: white;
      font-weight: 800;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 0 3px 10px rgba(255, 27, 141, 0.25);
      position: relative;
      overflow: hidden;
    }

    .send-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transition: left 0.5s;
    }

    .send-button:hover::before {
      left: 100%;
    }

    .send-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 16px rgba(255, 27, 141, 0.35);
    }

    .send-button:active {
      transform: translateY(0);
    }

    .send-button:disabled {
      background: linear-gradient(135deg, #d1d5db 0%, #9ca3af 100%);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .send-button:disabled::before {
      display: none;
    }

    /* ãƒ‘ãƒƒã‚¯ã‚°ãƒªãƒƒãƒ‰ */
    .packs-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 0.75rem;
    }

    .pack-card {
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 0.75rem;
      overflow: hidden;
      transition: all 0.2s;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .pack-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }

    .pack-image {
      width: 80px;
      height: 80px;
      flex-shrink: 0;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
    }

    .pack-content {
      padding: 0.75rem 0.75rem 0.75rem 0;
      flex: 1;
      min-width: 0;
    }

    .pack-name {
      font-size: 1rem;
      font-weight: 700;
      color: #2d1b3d;
      margin-bottom: 0.25rem;
    }

    .pack-description {
      color: #6b7280;
      font-size: 0.8125rem;
      margin-bottom: 0.75rem;
      line-height: 1.4;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .pack-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.75rem;
    }

    .pack-price {
      font-size: 1.125rem;
      font-weight: 800;
      color: #2d1b3d;
      white-space: nowrap;
    }

    .buy-button {
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      border: none;
      background: #FF1B8D;
      color: white;
      font-weight: 700;
      font-size: 0.8125rem;
      cursor: pointer;
      transition: all 0.2s;
      white-space: nowrap;
    }

    .buy-button:hover {
      background: #e01677;
      transform: translateY(-1px);
    }

    /* ãƒ¢ãƒã‚¤ãƒ«ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒœã‚¿ãƒ³ã¨ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã¯ css/style.css ã§å®šç¾© */

    .sidebar.mobile-open {
      display: flex;
    }

    /* ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ */
    @media (max-width: 768px) {
      body {
        display: block;
      }

      .mobile-menu-button {
        display: flex;
      }

      .sidebar {
        display: none;
      }

      .main-wrapper {
        margin-left: 0;
      }

      .creator-content {
        max-width: 100%;
      }

      /* é…ä¿¡è€…æƒ…å ±ãƒãƒ¼ï¼ˆãƒ¢ãƒã‚¤ãƒ«ï¼‰ */
      .stream-info-bar {
        padding: 0.75rem 1rem;
        gap: 0.75rem;
        align-items: center;
        flex-wrap: nowrap;
      }

      .creator-info-section {
        flex: 1;
        min-width: 0;
        gap: 0.75rem;
        align-items: center;
      }

      .creator-avatar {
        width: 40px;
        height: 40px;
        font-size: 1.125rem;
        position: relative;
      }

      .creator-info-text {
        min-width: 0;
        flex: 1;
      }

      .creator-name {
        font-size: 0.9375rem;
        line-height: 1.3;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .creator-meta {
        gap: 0.5rem;
        font-size: 0.75rem;
      }

      .stream-info-bar .following-button {
        padding: 0.5rem 0.75rem;
        font-size: 0.75rem;
        white-space: nowrap;
        flex-shrink: 0;
        align-self: center;
        position: static !important;
        transform: none !important;
        margin: 0;
        min-width: 90px;
        right: auto !important;
        top: auto !important;
      }

      .following-button:hover {
        transform: none !important;
      }

      .following-button:active {
        transform: none !important;
      }

      .following-button:hover span::before {
        content: 'ãƒ•ã‚©ãƒ­ãƒ¼è§£é™¤';
      }

      .following-button.unfollow-style:hover {
        transform: none !important;
      }

      .following-button.unfollow-style:active {
        transform: none !important;
      }

      .follower-count {
        font-size: 0.75rem;
      }

      .action-tab {
        padding: 0.75rem 0.5rem;
        font-size: 0.875rem;
      }

      .action-content {
        padding: 1rem;
        max-height: calc(100vh - 500px);
        min-height: 250px;
      }

      /* ã‚¹ãƒ—ãƒ©ãƒƒã‚·ãƒ¥ã‚¿ãƒ– - ãƒ¢ãƒã‚¤ãƒ«èª¿æ•´ */
      #splashContent {
        padding: 1rem 1.25rem;
        max-width: 100%;
      }

      .cards-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 0.75rem;
      }

      .card-item {
        padding: 0.75rem 0.5rem;
      }

      .card-icon-large {
        font-size: 2rem;
      }

      .use-btn {
        font-size: 0.75rem;
        padding: 0.25rem 0.5rem;
      }

      /* ã‚¹ãƒ—ãƒ©ãƒƒã‚·ãƒ¥ã‚¿ãƒ–ã‚’ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆã« */
      .splash-preview {
        padding: 0.625rem;
        margin-bottom: 0.5rem;
      }

      .splash-preview-header {
        margin-bottom: 0.375rem;
        gap: 0.5rem;
      }

      .splash-preview-avatar {
        width: 28px;
        height: 28px;
        font-size: 0.6875rem;
      }

      .splash-preview-name {
        font-size: 0.6875rem;
        margin-bottom: 0;
      }

      .splash-preview-amount {
        font-size: 0.8125rem;
      }

      .splash-preview-input {
        min-height: 40px;
        font-size: 0.75rem;
        padding: 0.375rem;
      }

      .splash-amount-input-wrapper {
        margin-bottom: 0.5rem;
      }

      .splash-amount-input {
        width: 80px;
        font-size: 1rem;
        padding: 0.25rem 0.25rem;
      }

      .splash-amount-unit {
        font-size: 0.75rem;
      }

      .splash-slider-container {
        margin-bottom: 0.5rem;
      }

      .splash-slider-wrapper {
        margin-bottom: 0.375rem;
      }

      .splash-slider {
        height: 5px;
      }

      .splash-slider::-webkit-slider-thumb {
        width: 16px;
        height: 16px;
      }

      .splash-slider::-moz-range-thumb {
        width: 16px;
        height: 16px;
      }

      .send-button {
        padding: 0.625rem;
        font-size: 0.875rem;
      }

      /* ã‚«ãƒ¼ãƒ‰ä½¿ç”¨ãƒ¢ãƒ¼ãƒ€ãƒ« - ãƒ¢ãƒã‚¤ãƒ« */
      .use-card-modal-content {
        padding: 1.5rem;
        max-width: 90%;
      }

      .use-card-modal-icon {
        font-size: 3rem;
        margin-bottom: 0.75rem;
      }

      .use-card-modal-title {
        font-size: 1.125rem;
      }

      .use-card-modal-message {
        font-size: 0.875rem;
        margin-bottom: 1.25rem;
      }

      .use-card-modal-button {
        font-size: 0.875rem;
        padding: 0.625rem 0.75rem;
      }

      /* ã‚«ãƒ¼ãƒ‰ä½¿ç”¨ãƒˆãƒ¼ã‚¹ãƒˆ - ãƒ¢ãƒã‚¤ãƒ« */
      .card-use-toast {
        min-width: 280px;
        padding: 1.5rem;
      }

      .card-use-toast-icon {
        font-size: 3rem;
        margin-bottom: 0.75rem;
      }

      .card-use-toast-title {
        font-size: 1.125rem;
      }

      .card-use-toast-message {
        font-size: 0.875rem;
      }
    }

    /* ã‚¹ãƒ ãƒ¼ã‚¹ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ« */
    html {
      scroll-behavior: smooth;
    }

    /* ã‚¿ãƒƒãƒãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ */
    button, .card-item, .splash-option, .pack-card {
      -webkit-tap-highlight-color: transparent;
    }
  </style>
</head>
<body>
  <!-- ãƒ¢ãƒã‚¤ãƒ«ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒœã‚¿ãƒ³ -->
  <button type="button" class="mobile-menu-button" id="mobileMenuButton" onclick="toggleMobileMenu()">
    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M15 19l-7-7 7-7"></path>
    </svg>
  </button>

  <!-- ãƒ¢ãƒã‚¤ãƒ«ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ -->
  <div class="mobile-menu-overlay" id="mobileMenuOverlay" onclick="closeMobileMenu()"></div>

  <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
  <aside class="sidebar" id="sidebar">
    <a href="../profile.html" class="sidebar-logo">
      <img src="../image/logo.png" alt="Pack&Play" class="sidebar-logo-img">
    </a>
    <nav class="sidebar-nav" id="sidebarNav">
      <!-- JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
    </nav>

    <div class="sidebar-footer">
      <div class="sidebar-footer-links">
        <a href="../legal/terms.html" class="sidebar-footer-link">åˆ©ç”¨è¦ç´„</a>
        <a href="../legal/privacy.html" class="sidebar-footer-link">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼</a>
        <a href="../legal/commerce.html" class="sidebar-footer-link">ç‰¹å•†æ³•è¡¨è¨˜</a>
        <a href="../legal/scta.html" class="sidebar-footer-link">è³‡é‡‘æ±ºæ¸ˆæ³•</a>
        <a href="../legal/contact.html" class="sidebar-footer-link">ãŠå•ã„åˆã‚ã›</a>
      </div>
      <div class="sidebar-footer-copyright">
        Â© 2025 Pack&Play
      </div>
    </div>
  </aside>

  <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ©ãƒƒãƒ‘ãƒ¼ -->
  <div class="main-wrapper">
    <main class="creator-content">
      <!-- é…ä¿¡ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ -->
      <div class="stream-player-wrapper">
        <!-- é…ä¿¡ä¸­ã®å ´åˆã¯iframeã‚’è¡¨ç¤º -->
        <iframe
          id="streamPlayer"
          class="stream-player"
          src=""
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
          allowfullscreen
          style="display: none;">
        </iframe>

        <!-- é…ä¿¡ã—ã¦ã„ãªã„å ´åˆ -->
        <div class="stream-offline" id="streamOffline">
          <div class="stream-offline-icon">ğŸ“º</div>
          <div class="stream-offline-text">ç¾åœ¨é…ä¿¡ã—ã¦ã„ã¾ã›ã‚“</div>
        </div>
      </div>

      <!-- é…ä¿¡è€…æƒ…å ±ãƒãƒ¼ï¼ˆçµ±åˆç‰ˆï¼‰ -->
      <div class="stream-info-bar" id="streamInfoBar">
        <div class="creator-info-section">
          <div class="creator-avatar" id="creatorAvatar">
            ç”°
            <span class="live-signal" id="liveSignal" style="display: none;"></span>
          </div>
          <div class="creator-info-text">
            <div class="creator-name" id="creatorName">ç”°ä¸­å¤ªéƒ</div>
            <div class="creator-meta">
              <span class="follower-count" id="followerCount">0 ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼</span>
            </div>
          </div>
        </div>
        <button type="button" class="following-button" id="followButton">
          <span>ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹</span>
        </button>
      </div>

      <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ‘ãƒãƒ« -->
      <div class="action-panel">
        <div class="action-tabs">
          <button type="button" class="action-tab active" id="overviewTab" onclick="switchActionTab('overview')">æ¦‚è¦</button>
          <button type="button" class="action-tab" onclick="switchActionTab('cards')">ã‚«ãƒ¼ãƒ‰</button>
          <button type="button" class="action-tab" onclick="switchActionTab('splash')">ã‚¹ãƒ—ãƒ©ãƒƒã‚·ãƒ¥</button>
          <button type="button" class="action-tab" onclick="switchActionTab('packs')">ãƒ‘ãƒƒã‚¯</button>
        </div>

        <!-- æ¦‚è¦ã‚¿ãƒ– -->
        <div class="action-content active" id="overviewContent">
          <div class="stream-description-wrapper">
            <div class="stream-description-content collapsed" id="streamDescription">
              <!-- JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
            </div>
            <div class="stream-description-fade" id="streamDescriptionFade"></div>
          </div>
          <button type="button" class="stream-description-toggle" id="streamDescriptionToggle" onclick="toggleDescription()" style="display: none;">
            <span id="toggleText">ã‚‚ã£ã¨è¦‹ã‚‹</span>
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
          </button>
          <div class="stream-description-empty" id="streamDescriptionEmpty" style="display: none;">
            é…ä¿¡æ¦‚è¦ã¯ã‚ã‚Šã¾ã›ã‚“
          </div>
        </div>

        <!-- ã‚«ãƒ¼ãƒ‰ã‚¿ãƒ– -->
        <div class="action-content" id="cardsContent">
          <div class="cards-grid" id="cardsGrid">
            <!-- JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
          </div>
        </div>

        <!-- ã‚¹ãƒ—ãƒ©ãƒƒã‚·ãƒ¥ã‚¿ãƒ– -->
        <div class="action-content" id="splashContent">
          <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ -->
          <div class="splash-preview" id="splashPreview" data-tier="1">
            <div class="splash-preview-header">
              <div class="splash-preview-avatar" id="splashPreviewAvatar">è¦–</div>
              <div class="splash-preview-info">
                <div class="splash-preview-name" id="splashPreviewName">è¦–è´è€…</div>
                <div class="splash-preview-amount" id="splashPreviewAmount">100ã‚¹ãƒ‘ãƒ¼ã‚¯</div>
              </div>
            </div>
            <div class="splash-preview-message">
              <textarea
                class="splash-preview-input"
                id="splashMessage"
                placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚‹ã«ã¯200ã‚¹ãƒ‘ãƒ¼ã‚¯ä»¥ä¸Šå¿…è¦ã§ã™"
                maxlength="0"
                disabled></textarea>
            </div>
          </div>

          <!-- é‡‘é¡ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« -->
          <div class="splash-slider-container">
            <!-- é‡‘é¡å…¥åŠ›ï¼ˆã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ä¸Šéƒ¨ä¸­å¤®ï¼‰ -->
            <div class="splash-amount-input-wrapper">
              <input
                type="number"
                class="splash-amount-input"
                id="splashAmountInput"
                min="100"
                max="50000"
                step="100"
                value="100"
                oninput="updateFromInput()"
                onkeydown="handleSparkKeydown(event)">
              <span class="splash-amount-unit">ã‚¹ãƒ‘ãƒ¼ã‚¯</span>
            </div>

            <!-- ã‚¹ãƒ©ã‚¤ãƒ‰ãƒãƒ¼ -->
            <div class="splash-slider-wrapper">
              <input
                type="range"
                class="splash-slider"
                id="splashSlider"
                min="0"
                max="10"
                value="0"
                step="1"
                oninput="updateFromSlider(this.value)">
            </div>
          </div>

          <!-- é€ä¿¡ãƒœã‚¿ãƒ³ -->
          <button type="button" class="send-button" id="sendSplashButton" onclick="sendSplash()">
            ã‚¹ãƒ—ãƒ©ãƒƒã‚·ãƒ¥ã‚’é€ã‚‹
          </button>
        </div>

        <!-- ãƒ‘ãƒƒã‚¯ã‚¿ãƒ– -->
        <div class="action-content" id="packsContent">
          <div class="packs-grid" id="packsGrid">
            <!-- JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
          </div>
        </div>
      </div>
    </main>
  </div>

  <script src="../js/mock-data.js"></script>
  <script src="../js/main.js"></script>
  <script>
    // é…ä¿¡è€…æƒ…å ±ã‚’å–å¾—
    const creatorSlug = 'tanaka';
    const creator = getCreatorBySlug(creatorSlug);
    const creatorPacks = getPacksByCreator(creatorSlug);

    // ã‚µã‚¤ãƒ‰ãƒãƒ¼ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
    renderSidebarNav(''); // main.jsã®å…±é€šé–¢æ•°ã‚’ä½¿ç”¨

    // ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼æƒ…å ±ã‚’è¨­å®š
    // Note: creatorAvatar text is hardcoded in HTML, don't use textContent as it removes child elements (live-signal)
    document.getElementById('creatorName').textContent = creator.name;

    // ãƒ•ã‚©ãƒ­ãƒ¼è§£é™¤
    function unfollowCreator(event) {
      event.preventDefault();
      event.stopPropagation();

      // ã‚«ã‚¹ã‚¿ãƒ ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤º
      showUnfollowModal();
    }

    // ãƒ•ã‚©ãƒ­ãƒ¼è§£é™¤ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤º
    function showUnfollowModal() {
      const modal = document.getElementById('unfollowModal');
      const message = document.getElementById('unfollowModalMessage');
      const confirmButton = document.getElementById('unfollowConfirmButton');

      message.textContent = `${creator.name}ã®ãƒ•ã‚©ãƒ­ãƒ¼ã‚’è§£é™¤ã—ã¾ã™ã‹ï¼Ÿ`;

      confirmButton.onclick = function() {
        toggleFollow(creator.id);

        // ãƒœã‚¿ãƒ³ã‚’ã€Œãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹ã€ã«å¤‰æ›´
        const button = document.getElementById('followButton');
        if (button) {
          button.className = 'following-button unfollow-style';
          button.innerHTML = '<span>ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹</span>';
          button.onclick = (e) => followCreator(e);
          button.blur();
        }

        closeUnfollowModal();
      };

      modal.classList.add('active');
    }

    // ãƒ•ã‚©ãƒ­ãƒ¼è§£é™¤ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
    function closeUnfollowModal() {
      const modal = document.getElementById('unfollowModal');
      modal.classList.remove('active');
    }

    // ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹
    function followCreator(event) {
      event.preventDefault();
      event.stopPropagation();

      toggleFollow(creator.id);

      // ãƒœã‚¿ãƒ³ã‚’ã€Œãƒ•ã‚©ãƒ­ãƒ¼ä¸­ã€ã«å¤‰æ›´
      const button = document.getElementById('followButton');
      if (button) {
        button.className = 'following-button';
        button.innerHTML = '<span>ãƒ•ã‚©ãƒ­ãƒ¼ä¸­</span>';
        button.onclick = (e) => unfollowCreator(e);
        button.blur();
      }
    }

    // åˆæœŸåŒ–ï¼šãƒ•ã‚©ãƒ­ãƒ¼çŠ¶æ…‹ã‚’ç¢ºèªã—ã¦ãƒœã‚¿ãƒ³ã‚’è¨­å®š
    function initFollowButton() {
      const followedIds = getFollowedCreators();
      const isFollowing = followedIds.includes(creator.id);
      const button = document.getElementById('followButton');

      if (button) {
        if (isFollowing) {
          button.className = 'following-button';
          button.innerHTML = '<span>ãƒ•ã‚©ãƒ­ãƒ¼ä¸­</span>';
          button.onclick = (e) => unfollowCreator(e);
        } else {
          button.className = 'following-button unfollow-style';
          button.innerHTML = '<span>ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹</span>';
          button.onclick = (e) => followCreator(e);
        }
      }
    }

    // é…ä¿¡ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®è¨­å®š
    function setupStreamPlayer() {
      const player = document.getElementById('streamPlayer');
      const offline = document.getElementById('streamOffline');
      const liveSignal = document.getElementById('liveSignal');

      console.log('Creator:', creator);
      console.log('isLive:', creator.isLive);
      console.log('liveSignal element:', liveSignal);

      if (creator.isLive && creator.streamUrl) {
        // é…ä¿¡ä¸­ã®å ´åˆ
        player.src = creator.streamUrl;
        player.style.display = 'block';
        offline.style.display = 'none';

        // LIVEä¿¡å·ã‚’è¡¨ç¤º
        if (liveSignal) {
          liveSignal.style.display = 'block';
          console.log('LIVE signal shown');
        } else {
          console.error('liveSignal element not found');
        }

        // é…ä¿¡æ¦‚è¦ã‚’è¨­å®š
        if (creator.streamDescription) {
          setupStreamDescription(creator.streamDescription);
        } else {
          showEmptyDescription();
        }
      } else {
        // é…ä¿¡ã—ã¦ã„ãªã„å ´åˆ
        player.style.display = 'none';
        offline.style.display = 'flex';

        // LIVEä¿¡å·ã‚’éè¡¨ç¤º
        if (liveSignal) {
          liveSignal.style.display = 'none';
        }

        showEmptyDescription();
      }
    }

    // ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼æ•°ã‚’æ›´æ–°
    function updateFollowerCount() {
      const followedIds = getFollowedCreators();
      const followerCount = Math.floor(Math.random() * 50000) + 1000; // ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿
      document.getElementById('followerCount').textContent = `${followerCount.toLocaleString()} ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼`;
    }

    // ç©ºã®æ¦‚è¦è¡¨ç¤º
    function showEmptyDescription() {
      document.getElementById('streamDescription').style.display = 'none';
      document.getElementById('streamDescriptionToggle').style.display = 'none';
      document.getElementById('streamDescriptionFade').style.display = 'none';
      document.getElementById('streamDescriptionEmpty').style.display = 'block';
    }

    // é…ä¿¡æ¦‚è¦ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
    function setupStreamDescription(description) {
      const descriptionElement = document.getElementById('streamDescription');
      const toggleButton = document.getElementById('streamDescriptionToggle');
      const fade = document.getElementById('streamDescriptionFade');
      const emptyElement = document.getElementById('streamDescriptionEmpty');

      descriptionElement.textContent = description;
      descriptionElement.style.display = 'block';
      emptyElement.style.display = 'none';

      // é«˜ã•ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ã€3è¡Œã‚’è¶…ãˆã‚‹å ´åˆã¯ãƒˆã‚°ãƒ«ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º
      setTimeout(() => {
        const lineHeight = parseFloat(getComputedStyle(descriptionElement).lineHeight);
        const maxHeight = lineHeight * 3;

        if (descriptionElement.scrollHeight > maxHeight) {
          toggleButton.style.display = 'flex';
          fade.style.display = 'block';
        } else {
          toggleButton.style.display = 'none';
          fade.style.display = 'none';
          descriptionElement.classList.remove('collapsed');
          descriptionElement.classList.add('expanded');
        }
      }, 0);
    }

    // é…ä¿¡æ¦‚è¦ã®å±•é–‹/æŠ˜ã‚ŠãŸãŸã¿
    function toggleDescription() {
      const descriptionElement = document.getElementById('streamDescription');
      const toggleButton = document.getElementById('streamDescriptionToggle');
      const toggleText = document.getElementById('toggleText');
      const fade = document.getElementById('streamDescriptionFade');

      const isExpanded = descriptionElement.classList.contains('expanded');

      if (isExpanded) {
        // æŠ˜ã‚ŠãŸãŸã‚€
        descriptionElement.classList.remove('expanded');
        descriptionElement.classList.add('collapsed');
        toggleButton.classList.remove('expanded');
        toggleText.textContent = 'ã‚‚ã£ã¨è¦‹ã‚‹';
        fade.style.display = 'block';
      } else {
        // å±•é–‹ã™ã‚‹
        descriptionElement.classList.remove('collapsed');
        descriptionElement.classList.add('expanded');
        toggleButton.classList.add('expanded');
        toggleText.textContent = 'é–‰ã˜ã‚‹';
        fade.style.display = 'none';
      }
    }


    // ã‚«ãƒ¼ãƒ‰ã‚’è¡¨ç¤º
    function renderCards() {
      const grid = document.getElementById('cardsGrid');

      // ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªã‹ã‚‰ã“ã®é…ä¿¡è€…ã®æœªä½¿ç”¨ã‚«ãƒ¼ãƒ‰ã®ã¿ã‚’å–å¾—
      const inventory = loadFromStorage('inventory', []);
      const creatorCards = inventory.filter(card => card.creatorSlug === creatorSlug && !card.isUsed);

      if (creatorCards.length === 0) {
        grid.innerHTML = `
          <div class="cards-empty">
            ${creator.name}ã®ã‚«ãƒ¼ãƒ‰ã‚’æŒã£ã¦ã„ã¾ã›ã‚“<br>
            ãƒ‘ãƒƒã‚¯ã‚’è³¼å…¥ã—ã¦ã‚«ãƒ¼ãƒ‰ã‚’ã‚²ãƒƒãƒˆã—ã‚ˆã†ï¼
          </div>
        `;
        return;
      }

      const cardIcons = {
        'message': 'ğŸ’¬',
        'action': 'âš¡',
        'visual': 'âœ¨'
      };

      grid.innerHTML = creatorCards.map((card, index) => `
        <div class="card-item">
          <div class="card-icon-large">${cardIcons[card.type] || 'ğŸ´'}</div>
          <div class="card-name">${card.name}</div>
          <div class="badge badge-rarity-${card.rarity.toLowerCase()}">${card.rarity}</div>
          <button type="button" class="use-btn" onclick="openUseCardModal(${index})">ä½¿ã†</button>
        </div>
      `).join('');
    }

    let selectedCardForUse = null;

    function openUseCardModal(index) {
      const inventory = loadFromStorage('inventory', []);
      const creatorCards = inventory.filter(card => card.creatorSlug === creatorSlug && !card.isUsed);
      selectedCardForUse = creatorCards[index];

      const cardIcons = {
        'message': 'ğŸ’¬',
        'action': 'âš¡',
        'visual': 'âœ¨'
      };

      // ãƒ¢ãƒ¼ãƒ€ãƒ«ã®å†…å®¹ã‚’è¨­å®š
      document.getElementById('useCardModalIcon').textContent = cardIcons[selectedCardForUse.type] || 'ğŸ´';
      document.getElementById('useCardModalTitle').textContent = selectedCardForUse.name;
      document.getElementById('useCardModalBadge').textContent = selectedCardForUse.rarity;
      document.getElementById('useCardModalBadge').className = `badge badge-rarity-${selectedCardForUse.rarity.toLowerCase()}`;

      const cardTypeText = {
        'message': 'ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚«ãƒ¼ãƒ‰',
        'action': 'ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚«ãƒ¼ãƒ‰',
        'visual': 'ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã‚«ãƒ¼ãƒ‰'
      };
      document.getElementById('useCardModalMessage').textContent = `ã“ã®${cardTypeText[selectedCardForUse.type]}ã‚’ä½¿ç”¨ã—ã¾ã™ã‹ï¼Ÿ`;

      // ç¢ºèªãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¨­å®š
      document.getElementById('useCardConfirmButton').onclick = function() {
        closeUseCardModal();
        useCard(selectedCardForUse);
      };

      // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤º
      document.getElementById('useCardModal').classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closeUseCardModal() {
      document.getElementById('useCardModal').classList.remove('active');
      document.body.style.overflow = '';
    }

    // ãƒ¢ãƒ¼ãƒ€ãƒ«å¤–ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹
    document.addEventListener('click', function(e) {
      if (e.target.id === 'useCardModal') {
        closeUseCardModal();
      }
    });

    function useCard(card) {
      showLoading();

      setTimeout(() => {
        hideLoading();

        // ã‚«ãƒ¼ãƒ‰ã‚’ä½¿ç”¨æ¸ˆã¿ã«ãƒãƒ¼ã‚¯
        const inventory = loadFromStorage('inventory', []);
        const cardIndex = inventory.findIndex(c =>
          c.id === card.id &&
          c.acquiredAt === card.acquiredAt &&
          c.creatorSlug === card.creatorSlug
        );

        if (cardIndex !== -1) {
          inventory[cardIndex].isUsed = true;
          saveToStorage('inventory', inventory);

          // æ‰¿èªå¾…ã¡ã‚­ãƒ¥ãƒ¼ã«è¿½åŠ ï¼ˆmessageã‚¿ã‚¤ãƒ—ã®å ´åˆï¼‰
          if (card.type === 'message') {
            const redemptions = loadFromStorage('redemptions', []);
            redemptions.push({
              id: Date.now(),
              cardId: card.id,
              cardName: card.name,
              cardType: card.type,
              rarity: card.rarity,
              viewerName: 'è¦–è´è€…',
              message: 'ï¼ˆã‚«ãƒ¼ãƒ‰ä½¿ç”¨ï¼‰',
              timestamp: new Date().toISOString(),
              status: 'pending'
            });
            saveToStorage('redemptions', redemptions);
          }

          renderCards(); // ã‚«ãƒ¼ãƒ‰ä¸€è¦§ã‚’å†æç”»
          showCardUseToast(card); // ã‚«ã‚¹ã‚¿ãƒ ãƒˆãƒ¼ã‚¹ãƒˆè¡¨ç¤º
        } else {
          showToast('ã‚«ãƒ¼ãƒ‰ã®ä½¿ç”¨ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
        }
      }, 500);
    }

    // ã‚«ãƒ¼ãƒ‰ä½¿ç”¨ãƒˆãƒ¼ã‚¹ãƒˆã‚’è¡¨ç¤º
    function showCardUseToast(card) {
      const cardIcons = {
        'message': 'ğŸ’¬',
        'action': 'âš¡',
        'visual': 'âœ¨'
      };

      // ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã‚’ä½œæˆ
      const overlay = document.createElement('div');
      overlay.className = 'card-use-toast-overlay';
      document.body.appendChild(overlay);

      // ãƒˆãƒ¼ã‚¹ãƒˆã‚’ä½œæˆ
      const toast = document.createElement('div');
      toast.className = 'card-use-toast';
      toast.innerHTML = `
        <div class="card-use-toast-icon">${cardIcons[card.type] || 'ğŸ´'}</div>
        <div class="card-use-toast-title">${card.name}</div>
        <div class="badge badge-rarity-${card.rarity.toLowerCase()}">${card.rarity}</div>
        <div class="card-use-toast-message">ã‚«ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã—ãŸ</div>
      `;
      document.body.appendChild(toast);

      // 1.5ç§’å¾Œã«ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆ
      setTimeout(() => {
        toast.classList.add('fade-out');
        overlay.classList.add('fade-out');

        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®Œäº†å¾Œã«å‰Šé™¤
        setTimeout(() => {
          document.body.removeChild(toast);
          document.body.removeChild(overlay);
        }, 300);
      }, 1500);
    }

    // ã‚¹ãƒ—ãƒ©ãƒƒã‚·ãƒ¥é‡‘é¡è¨­å®š
    const splashAmounts = [100, 200, 500, 1000, 2000, 5000, 10000, 20000, 30000, 40000, 50000];
    let selectedSplashAmount = 100;

    // é‡‘é¡ã‹ã‚‰è‰²ã®ãƒ†ã‚£ã‚¢ã‚’è¨ˆç®—
    function getAmountTier(amount) {
      if (amount < 500) return 1;
      if (amount < 2000) return 2;
      if (amount < 5000) return 3;
      if (amount < 10000) return 4;
      if (amount < 30000) return 5;
      return 6;
    }

    // ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã‹ã‚‰ãƒ†ã‚£ã‚¢ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’å–å¾—
    function getSliderIndexForAmount(amount) {
      for (let i = splashAmounts.length - 1; i >= 0; i--) {
        if (amount >= splashAmounts[i]) {
          return i;
        }
      }
      return 0;
    }

    // é‡‘é¡ã«å¿œã˜ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ–‡å­—æ•°åˆ¶é™ã‚’å–å¾—
    function getMessageMaxLength(amount) {
      if (amount <= 100) return 0; // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¸å¯
      if (amount < 1000) return 50;
      if (amount < 5000) return 100;
      if (amount < 20000) return 150;
      return 200;
    }

    // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ›´æ–°
    function updatePreview(amount) {
      selectedSplashAmount = amount;
      const tier = getAmountTier(amount);
      const maxLength = getMessageMaxLength(amount);

      const preview = document.getElementById('splashPreview');
      const amountDisplay = document.getElementById('splashPreviewAmount');
      const messageInput = document.getElementById('splashMessage');

      preview.setAttribute('data-tier', tier);
      amountDisplay.textContent = `${amount.toLocaleString()}ã‚¹ãƒ‘ãƒ¼ã‚¯`;

      // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å…¥åŠ›ã®åˆ¶å¾¡
      if (amount <= 100) {
        messageInput.disabled = true;
        messageInput.value = '';
        messageInput.placeholder = 'ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚‹ã«ã¯200ã‚¹ãƒ‘ãƒ¼ã‚¯ä»¥ä¸Šå¿…è¦ã§ã™';
        messageInput.maxLength = 0;
      } else {
        messageInput.disabled = false;
        messageInput.placeholder = `ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›...ï¼ˆæœ€å¤§${maxLength}æ–‡å­—ï¼‰`;
        messageInput.maxLength = maxLength;

        // æ—¢å­˜ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒæ–°ã—ã„åˆ¶é™ã‚’è¶…ãˆã¦ã„ã‚‹å ´åˆã¯åˆ‡ã‚Šè©°ã‚ã‚‹
        if (messageInput.value.length > maxLength) {
          messageInput.value = messageInput.value.substring(0, maxLength);
        }
      }
    }

    // ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã‹ã‚‰æ›´æ–°
    function updateFromSlider(sliderValue) {
      const index = parseInt(sliderValue);
      const amount = splashAmounts[index];

      document.getElementById('splashAmountInput').value = amount;
      updatePreview(amount);
    }

    // å…¥åŠ›æ¬„ã‹ã‚‰æ›´æ–°
    function updateFromInput() {
      const input = document.getElementById('splashAmountInput');
      let amount = parseInt(input.value) || 100;

      // ç¯„å›²ãƒã‚§ãƒƒã‚¯
      if (amount < 100) amount = 100;
      if (amount > 50000) amount = 50000;

      input.value = amount;

      // ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã®ä½ç½®ã‚’æ›´æ–°
      const sliderIndex = getSliderIndexForAmount(amount);
      document.getElementById('splashSlider').value = sliderIndex;

      updatePreview(amount);
    }

    // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã®å·¦å³çŸ¢å°ã‚­ãƒ¼ã§é‡‘é¡å¤‰æ›´
    function handleSparkKeydown(event) {
      const input = document.getElementById('splashAmountInput');
      let amount = parseInt(input.value) || 100;

      if (event.key === 'ArrowLeft') {
        // å·¦çŸ¢å°: -100
        event.preventDefault();
        amount = Math.max(100, amount - 100);
        input.value = amount;
        updateFromInput();
      } else if (event.key === 'ArrowRight') {
        // å³çŸ¢å°: +100
        event.preventDefault();
        amount = Math.min(50000, amount + 100);
        input.value = amount;
        updateFromInput();
      }
    }

    function sendSplash() {
      const message = document.getElementById('splashMessage').value;

      // å®Ÿéš›ã®ã‚¢ãƒ—ãƒªã§ã¯æ±ºæ¸ˆå‡¦ç†ã‚’å®Ÿè£…
      alert(`${selectedSplashAmount.toLocaleString()}ã‚¹ãƒ‘ãƒ¼ã‚¯ ã®ã‚¹ãƒ—ãƒ©ãƒƒã‚·ãƒ¥ã‚’é€ä¿¡ã—ã¾ã—ãŸï¼\nãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: ${message || 'ãªã—'}`);

      // ãƒªã‚»ãƒƒãƒˆ
      document.getElementById('splashMessage').value = '';
      document.getElementById('splashAmountInput').value = '100';
      document.getElementById('splashSlider').value = '0';
      updatePreview(100);
    }

    // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
    function switchActionTab(tab) {
      // ã‚¿ãƒ–ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹ã‚’æ›´æ–°
      document.querySelectorAll('.action-tab').forEach(btn => {
        btn.classList.remove('active');
      });
      event.currentTarget.classList.add('active');

      // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è¡¨ç¤ºã‚’åˆ‡ã‚Šæ›¿ãˆ
      document.querySelectorAll('.action-content').forEach(content => {
        content.classList.remove('active');
      });

      if (tab === 'overview') {
        document.getElementById('overviewContent').classList.add('active');
      } else if (tab === 'cards') {
        document.getElementById('cardsContent').classList.add('active');
      } else if (tab === 'splash') {
        document.getElementById('splashContent').classList.add('active');
      } else if (tab === 'packs') {
        document.getElementById('packsContent').classList.add('active');
      }
    }

    // ãƒ‘ãƒƒã‚¯ã‚’è¡¨ç¤º
    function renderPacks() {
      const grid = document.getElementById('packsGrid');

      if (creatorPacks.length === 0) {
        grid.innerHTML = `
          <div style="text-align: center; padding: 3rem; color: #9ca3af;">
            ğŸ“¦ ãƒ‘ãƒƒã‚¯ãŒã‚ã‚Šã¾ã›ã‚“
          </div>
        `;
        return;
      }

      grid.innerHTML = creatorPacks.map(pack => `
        <div class="pack-card" onclick="viewPack(${pack.id})">
          <div class="pack-image">ğŸ“¦</div>
          <div class="pack-content">
            <div class="pack-name">${pack.name}</div>
            <p class="pack-description">${pack.description}</p>
            <div class="pack-footer">
              <div class="pack-price">Â¥${pack.price.toLocaleString()}</div>
              <button type="button" class="buy-button" onclick="event.stopPropagation(); purchasePack(${pack.id})">
                è³¼å…¥ã™ã‚‹
              </button>
            </div>
          </div>
        </div>
      `).join('');
    }

    function viewPack(packId) {
      window.location.href = `../packs/pack-detail.html?id=${packId}`;
    }

    function purchasePack(packId) {
      // å®Ÿéš›ã®ã‚¢ãƒ—ãƒªã§ã¯æ±ºæ¸ˆå‡¦ç†ã‚’å®Ÿè£…
      if (confirm('ã“ã®ãƒ‘ãƒƒã‚¯ã‚’è³¼å…¥ã—ã¾ã™ã‹ï¼Ÿ')) {
        alert('è³¼å…¥å‡¦ç†ã‚’é–‹å§‹ã—ã¾ã™...');
        // è³¼å…¥å¾Œã¯pack-open.htmlã¸é·ç§»
        setTimeout(() => {
          window.location.href = `../packs/pack-open.html?id=${packId}`;
        }, 1000);
      }
    }

    // ãƒ¢ãƒã‚¤ãƒ«ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®é–‹é–‰
    function toggleMobileMenu() {
      const sidebar = document.getElementById('sidebar');
      const button = document.getElementById('mobileMenuButton');
      const overlay = document.getElementById('mobileMenuOverlay');

      const isOpen = sidebar.classList.contains('mobile-open');

      if (isOpen) {
        closeMobileMenu();
      } else {
        openMobileMenu();
      }
    }

    function openMobileMenu() {
      const sidebar = document.getElementById('sidebar');
      const button = document.getElementById('mobileMenuButton');
      const overlay = document.getElementById('mobileMenuOverlay');

      sidebar.classList.add('mobile-open');
      button.classList.add('active');
      overlay.style.display = 'block';
      document.body.style.overflow = 'hidden';
    }

    function closeMobileMenu() {
      const sidebar = document.getElementById('sidebar');
      const button = document.getElementById('mobileMenuButton');
      const overlay = document.getElementById('mobileMenuOverlay');

      sidebar.classList.remove('mobile-open');
      button.classList.remove('active');
      overlay.style.display = 'none';
      document.body.style.overflow = '';
    }

    // ã‚µãƒ³ãƒ—ãƒ«ã‚«ãƒ¼ãƒ‰ã‚’è¿½åŠ 
    function addSampleCards() {
      const inventory = loadFromStorage('inventory', []);

      // æ—¢ã«tanakaã®ã‚«ãƒ¼ãƒ‰ãŒã‚ã‚‹å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—
      const hasTanakaCards = inventory.some(card => card.creatorSlug === 'tanaka');
      if (hasTanakaCards) {
        return;
      }

      // ã‚µãƒ³ãƒ—ãƒ«ã‚«ãƒ¼ãƒ‰ã‚’è¿½åŠ 
      const sampleCards = [
        {
          id: 1,
          name: 'ã“ã‚“ã«ã¡ã¯',
          rarity: 'N',
          type: 'message',
          creatorName: 'ç”°ä¸­å¤ªéƒ',
          creatorSlug: 'tanaka',
          isUsed: false,
          acquiredAt: new Date().toISOString()
        },
        {
          id: 2,
          name: 'ã„ã„ã­ï¼',
          rarity: 'R',
          type: 'action',
          creatorName: 'ç”°ä¸­å¤ªéƒ',
          creatorSlug: 'tanaka',
          isUsed: false,
          acquiredAt: new Date().toISOString()
        },
        {
          id: 3,
          name: 'ãã‚‰ãã‚‰',
          rarity: 'SR',
          type: 'visual',
          creatorName: 'ç”°ä¸­å¤ªéƒ',
          creatorSlug: 'tanaka',
          isUsed: false,
          acquiredAt: new Date().toISOString()
        },
        {
          id: 5,
          name: 'ã‚ã‚ŠãŒã¨ã†',
          rarity: 'R',
          type: 'message',
          creatorName: 'ç”°ä¸­å¤ªéƒ',
          creatorSlug: 'tanaka',
          isUsed: false,
          acquiredAt: new Date().toISOString()
        },
        {
          id: 4,
          name: 'æ¿€ãƒ¬ã‚¢ã‚«ãƒ¼ãƒ‰',
          rarity: 'UR',
          type: 'action',
          creatorName: 'ç”°ä¸­å¤ªéƒ',
          creatorSlug: 'tanaka',
          isUsed: false,
          acquiredAt: new Date().toISOString()
        }
      ];

      inventory.push(...sampleCards);
      saveToStorage('inventory', inventory);
    }

    // åˆæœŸåŒ–
    function init() {
      addSampleCards(); // ã‚µãƒ³ãƒ—ãƒ«ã‚«ãƒ¼ãƒ‰ã‚’è¿½åŠ 
      initFollowButton();
      updateFollowerCount();
      setupStreamPlayer();
      renderCards();
      renderPacks();

      // ã‚¹ãƒ—ãƒ©ãƒƒã‚·ãƒ¥ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«è¦–è´è€…ï¼ˆãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰æƒ…å ±ã‚’è¨­å®š
      const session = getCurrentSession();
      if (session && session.displayName) {
        document.getElementById('splashPreviewAvatar').textContent = session.displayName.charAt(0);
        document.getElementById('splashPreviewName').textContent = session.displayName;
      } else {
        // ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ãªã„å ´åˆã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ
        document.getElementById('splashPreviewAvatar').textContent = 'ã‚';
        document.getElementById('splashPreviewName').textContent = 'ã‚ãªãŸ';
      }
    }

    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«åˆæœŸåŒ–
    init();
  </script>

  <!-- ãƒ•ã‚©ãƒ­ãƒ¼è§£é™¤ç¢ºèªãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div class="confirm-modal" id="unfollowModal">
    <div class="confirm-modal-content">
      <div class="confirm-modal-title">ãƒ•ã‚©ãƒ­ãƒ¼è§£é™¤ã®ç¢ºèª</div>
      <div class="confirm-modal-message" id="unfollowModalMessage"></div>
      <div class="confirm-modal-buttons">
        <button type="button" class="confirm-modal-button confirm-modal-button-cancel" onclick="closeUnfollowModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button type="button" class="confirm-modal-button confirm-modal-button-confirm" id="unfollowConfirmButton">è§£é™¤ã™ã‚‹</button>
      </div>
    </div>
  </div>

  <!-- ã‚«ãƒ¼ãƒ‰ä½¿ç”¨ç¢ºèªãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div class="use-card-modal" id="useCardModal">
    <div class="use-card-modal-content">
      <div class="use-card-modal-header">
        <div class="use-card-modal-icon" id="useCardModalIcon">ğŸ´</div>
        <div class="use-card-modal-title" id="useCardModalTitle">ã‚«ãƒ¼ãƒ‰ã‚’ä½¿ç”¨</div>
        <div class="badge" id="useCardModalBadge"></div>
      </div>
      <div class="use-card-modal-message" id="useCardModalMessage">
        ã“ã®ã‚«ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã‹ï¼Ÿ
      </div>
      <div class="use-card-modal-buttons">
        <button type="button" class="use-card-modal-button use-card-modal-button-cancel" onclick="closeUseCardModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button type="button" class="use-card-modal-button use-card-modal-button-confirm" id="useCardConfirmButton">ä½¿ç”¨ã™ã‚‹</button>
      </div>
    </div>
  </div>
</body>
</html>
